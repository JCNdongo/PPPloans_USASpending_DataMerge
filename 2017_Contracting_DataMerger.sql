-- create table for part 1 of 2017 contracting data
CREATE TABLE "2017_Contracting_1" (
    BusinessUEI VARCHAR(255),
    "2017_total_dollars_obligated" DECIMAL(18, 2),
    "2017_total_outlayed_amount_for_overall_award" DECIMAL(18, 2),
    "2017_current_total_value_of_award" DECIMAL(18, 2),
    "2017_base_and_all_options_value" DECIMAL(18, 2),
    "2017_potential_total_value_of_award" DECIMAL(18, 2),
    "2017_number_of_offers_received" numeric,
    BusinessName VARCHAR(255),
    City VARCHAR(255),
    State VARCHAR(255),
    ZipCode VARCHAR(50),
    NAICS VARCHAR(10),
    NAICSDescription VARCHAR(255),
    alaskan_native VARCHAR(1),
    american_indian VARCHAR(1),
    indian_tribe VARCHAR(1),
    native_hawaiian VARCHAR(1),
    tribally_owned VARCHAR(1),
    veteran_owned VARCHAR(1),
    service_disabled_veteran VARCHAR(1),
    woman_owned VARCHAR(1),
    WOSB VARCHAR(1),
    econ_disadv_WOSB VARCHAR(1),
    jointVenture_WOSB VARCHAR(1),
    jointVenture_econ_disadv_WOSB VARCHAR(1),
    minority_owned VARCHAR(1),
    subcontinent_asian_indian_american VARCHAR(1),
    asian_pacific_american VARCHAR(1),
    black_american VARCHAR(1),
    hispanic_american VARCHAR(1),
    native_american VARCHAR(1),
    other_minority VARCHAR(1),
    usaspending_permalink VARCHAR(255)
);

-- create table for part 2 of 2017 contracting data
CREATE TABLE "2017_Contracting_2" (
    BusinessUEI VARCHAR(255),
    "2017_total_dollars_obligated" DECIMAL(18, 2),
    "2017_total_outlayed_amount_for_overall_award" DECIMAL(18, 2),
    "2017_current_total_value_of_award" DECIMAL(18, 2),
    "2017_base_and_all_options_value" DECIMAL(18, 2),
    "2017_potential_total_value_of_award" DECIMAL(18, 2),
    "2017_number_of_offers_received" numeric,
    BusinessName VARCHAR(255),
    City VARCHAR(255),
    State VARCHAR(255),
    ZipCode VARCHAR(50),
    NAICS VARCHAR(10),
    NAICSDescription VARCHAR(255),
    alaskan_native VARCHAR(1),
    american_indian VARCHAR(1),
    indian_tribe VARCHAR(1),
    native_hawaiian VARCHAR(1),
    tribally_owned VARCHAR(1),
    veteran_owned VARCHAR(1),
    service_disabled_veteran VARCHAR(1),
    woman_owned VARCHAR(1),
    WOSB VARCHAR(1),
    econ_disadv_WOSB VARCHAR(1),
    jointVenture_WOSB VARCHAR(1),
    jointVenture_econ_disadv_WOSB VARCHAR(1),
    minority_owned VARCHAR(1),
    subcontinent_asian_indian_american VARCHAR(1),
    asian_pacific_american VARCHAR(1),
    black_american VARCHAR(1),
    hispanic_american VARCHAR(1),
    native_american VARCHAR(1),
    other_minority VARCHAR(1),
    usaspending_permalink VARCHAR(255)
);

-- create table for part 3 of 2017 contracting data
CREATE TABLE "2017_Contracting_3" (
    BusinessUEI VARCHAR(255),
    "2017_total_dollars_obligated" DECIMAL(18, 2),
    "2017_total_outlayed_amount_for_overall_award" DECIMAL(18, 2),
    "2017_current_total_value_of_award" DECIMAL(18, 2),
    "2017_base_and_all_options_value" DECIMAL(18, 2),
    "2017_potential_total_value_of_award" DECIMAL(18, 2),
    "2017_number_of_offers_received" numeric,
    BusinessName VARCHAR(255),
    City VARCHAR(255),
    State VARCHAR(255),
    ZipCode VARCHAR(50),
    NAICS VARCHAR(10),
    NAICSDescription VARCHAR(255),
    alaskan_native VARCHAR(1),
    american_indian VARCHAR(1),
    indian_tribe VARCHAR(1),
    native_hawaiian VARCHAR(1),
    tribally_owned VARCHAR(1),
    veteran_owned VARCHAR(1),
    service_disabled_veteran VARCHAR(1),
    woman_owned VARCHAR(1),
    WOSB VARCHAR(1),
    econ_disadv_WOSB VARCHAR(1),
    jointVenture_WOSB VARCHAR(1),
    jointVenture_econ_disadv_WOSB VARCHAR(1),
    minority_owned VARCHAR(1),
    subcontinent_asian_indian_american VARCHAR(1),
    asian_pacific_american VARCHAR(1),
    black_american VARCHAR(1),
    hispanic_american VARCHAR(1),
    native_american VARCHAR(1),
    other_minority VARCHAR(1),
    usaspending_permalink VARCHAR(255)
);

-- create table for part 4 of 2017 contracting data
CREATE TABLE "2017_Contracting_4" (
    BusinessUEI VARCHAR(255),
    "2017_total_dollars_obligated" DECIMAL(18, 2),
    "2017_total_outlayed_amount_for_overall_award" DECIMAL(18, 2),
    "2017_current_total_value_of_award" DECIMAL(18, 2),
    "2017_base_and_all_options_value" DECIMAL(18, 2),
    "2017_potential_total_value_of_award" DECIMAL(18, 2),
    "2017_number_of_offers_received" numeric,
    BusinessName VARCHAR(255),
    City VARCHAR(255),
    State VARCHAR(255),
    ZipCode VARCHAR(50),
    NAICS VARCHAR(10),
    NAICSDescription VARCHAR(255),
    alaskan_native VARCHAR(1),
    american_indian VARCHAR(1),
    indian_tribe VARCHAR(1),
    native_hawaiian VARCHAR(1),
    tribally_owned VARCHAR(1),
    veteran_owned VARCHAR(1),
    service_disabled_veteran VARCHAR(1),
    woman_owned VARCHAR(1),
    WOSB VARCHAR(1),
    econ_disadv_WOSB VARCHAR(1),
    jointVenture_WOSB VARCHAR(1),
    jointVenture_econ_disadv_WOSB VARCHAR(1),
    minority_owned VARCHAR(1),
    subcontinent_asian_indian_american VARCHAR(1),
    asian_pacific_american VARCHAR(1),
    black_american VARCHAR(1),
    hispanic_american VARCHAR(1),
    native_american VARCHAR(1),
    other_minority VARCHAR(1),
    usaspending_permalink VARCHAR(255)
);

-- create table for part 5 of 2017 contracting data
CREATE TABLE "2017_Contracting_5" (
    BusinessUEI VARCHAR(255),
    "2017_total_dollars_obligated" DECIMAL(18, 2),
    "2017_total_outlayed_amount_for_overall_award" DECIMAL(18, 2),
    "2017_current_total_value_of_award" DECIMAL(18, 2),
    "2017_base_and_all_options_value" DECIMAL(18, 2),
    "2017_potential_total_value_of_award" DECIMAL(18, 2),
    "2017_number_of_offers_received" numeric,
    BusinessName VARCHAR(255),
    City VARCHAR(255),
    State VARCHAR(255),
    ZipCode VARCHAR(50),
    NAICS VARCHAR(10),
    NAICSDescription VARCHAR(255),
    alaskan_native VARCHAR(1),
    american_indian VARCHAR(1),
    indian_tribe VARCHAR(1),
    native_hawaiian VARCHAR(1),
    tribally_owned VARCHAR(1),
    veteran_owned VARCHAR(1),
    service_disabled_veteran VARCHAR(1),
    woman_owned VARCHAR(1),
    WOSB VARCHAR(1),
    econ_disadv_WOSB VARCHAR(1),
    jointVenture_WOSB VARCHAR(1),
    jointVenture_econ_disadv_WOSB VARCHAR(1),
    minority_owned VARCHAR(1),
    subcontinent_asian_indian_american VARCHAR(1),
    asian_pacific_american VARCHAR(1),
    black_american VARCHAR(1),
    hispanic_american VARCHAR(1),
    native_american VARCHAR(1),
    other_minority VARCHAR(1),
    usaspending_permalink VARCHAR(255)
);

-- import data from 2017_Contracting_1.csv file into 2017_Contracting_1 SQL table
COPY public."2017_Contracting_1" FROM 'F:/FAU PhD/DISSERTATION/DATABASES/DataTESTS/2023.08.27_Test/2017_Contracting_1.csv' WITH CSV HEADER;

SELECT *
FROM public."2017_Contracting_1"
LIMIT 5;

-- import data from 2017_Contracting_2.csv file into 2017_Contracting_2 SQL table
COPY public."2017_Contracting_2" FROM 'F:/FAU PhD/DISSERTATION/DATABASES/DataTESTS/2023.08.27_Test/2017_Contracting_2.csv' WITH CSV HEADER;

SELECT *
FROM public."2017_Contracting_2"
LIMIT 5;

-- import data from 2017_Contracting_3.csv file into 2017_Contracting_3 SQL table
COPY public."2017_Contracting_3" FROM 'F:/FAU PhD/DISSERTATION/DATABASES/DataTESTS/2023.08.27_Test/2017_Contracting_3.csv' WITH CSV HEADER;

SELECT *
FROM public."2017_Contracting_3"
LIMIT 5;

-- import data from 2017_Contracting_4.csv file into 2017_Contracting_4 SQL table
COPY public."2017_Contracting_4" FROM 'F:/FAU PhD/DISSERTATION/DATABASES/DataTESTS/2023.08.27_Test/2017_Contracting_4.csv' WITH CSV HEADER;

SELECT *
FROM public."2017_Contracting_4"
LIMIT 5;

-- import data from 2017_Contracting_5.csv file into 2017_Contracting_5 SQL table
COPY public."2017_Contracting_5" FROM 'F:/FAU PhD/DISSERTATION/DATABASES/DataTESTS/2023.08.27_Test/2017_Contracting_5.csv' WITH CSV HEADER;

SELECT *
FROM public."2017_Contracting_5"
LIMIT 5;

-- Create the All_2017_Contracting table to merge data from all 2017 source tables
CREATE TABLE public."All_2017_Contracting" AS
SELECT * FROM public."2017_Contracting_1"
UNION ALL
SELECT * FROM public."2017_Contracting_2"
UNION ALL
SELECT * FROM public."2017_Contracting_3"
UNION ALL
SELECT * FROM public."2017_Contracting_4"
UNION ALL
SELECT * FROM public."2017_Contracting_5";

SELECT *
FROM public."All_2017_Contracting"
LIMIT 5;

SELECT COUNT(*) FROM public."All_2017_Contracting";